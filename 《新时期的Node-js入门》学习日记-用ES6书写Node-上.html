<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">《新时期的Node.js入门》学习日记-用ES6书写Node(上) | 0xGeekCat</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "Mаксим0xGeekCat";
  mashiro_option.author_name = "0xGeekCat";
  mashiro_option.site_url = "https://0xgeekcat.github.io/";
  mashiro_option.v_appId = "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz";
  mashiro_option.v_appKey = "mgOpfzbkHYqU92CV4IDlAUHQ";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/images/Konachan.com%20ls%20black_hair%20f%20toriki%20touhou.jpg,https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/images/Konachan.com-293503-ghostblade-long_hair-red_hair-sword-tagme_character-thighhighs-weapon-wlop-scaled.jpg,https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/images/Konachan.com-298784-aeolian_wlop-barefoot-black_hair-braids-ghostblade-headdress-long_hair-ponytail-wlop-scaled.jpg,https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/images/Konachan.com%20-%20227403%20black_hair%20ghostblade%20jade_(wlop)%20japanese_clothes%20kimono%20logo%20realistic%20short_hair%20tattoo%20umbrella%20wlop.jpg,https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/images/Konachan.com-281267-aeolian_wlop-black_hair-bow_weapon-close-ghostblade-green_eyes-logo-long_hair-realistic-watermark-weapon-wink-wlop-scaled.jpg".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop filter-dim">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://0xgeekcat.github.io/">
          <img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/custom/avatar.jpg">
        </a>
      </div>
      <div class="header-info">
        <p>用来记录我大学最后生涯破釜沉舟力挽狂澜的疯狂学习历程</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="https://github.com/0xGeekCat" target="_blank" class="social-github" title="github">
                    <img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/social/github.png">
                  </a>
                </li>
              
            
              
                <li>
                  <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=1292881925@qq.com" target="_blank" class="social-github" title="email">
                    <img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/social/email.svg">
                  </a>
                </li>
              
            
              
                <li class="wechat">
                  <a href="/#">
                    <img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/social/wechat.png">
                  </a>
                  <div class="wechatInner">
                    <img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/custom/wechat.jpg">
                  </div>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">Mаксим</span>
            <span class="shironeko">0xGeekCat</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/categories/%E6%8A%80%E6%9C%AF/">
                          <i class="fa fa-code" aria-hidden="true"></i>
                          技术
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/%E7%94%9F%E6%B4%BB/">
                          <i class="fa fa-file-text-o" aria-hidden="true"></i>
                          生活
                        </a>
                      </li>
                    
                      <li>
                        <a href="/categories/%E8%BD%AC%E8%BD%BD/">
                          <i class="fa fa-book" aria-hidden="true"></i>
                          转载
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="javascript:;">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
                    书单
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/tags/%E5%B7%B2%E8%AF%BB/">
                          <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                          已读
                        </a>
                      </li>
                    
                      <li>
                        <a href="/tags/%E6%9C%AA%E8%AF%BB/">
                          <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                          未读
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
                    关于
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                      <li>
                        <a href="/about/">
                          <i class="fa fa-meetup" aria-hidden="true"></i>
                          我？
                        </a>
                      </li>
                    
                  </ul>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
          <header class="entry-header">
            <h1 class="entry-title">《新时期的Node.js入门》学习日记-用ES6书写Node(上)</h1>
            <p class="entry-census">0xGeekCat&nbsp;·&nbsp;2020-8-29&nbsp;·&nbsp;<span id="busuanzi_value_page_pv"></span>次阅读</p></p>

            <hr>
          </header>
        
        <div class="entry-content">
          <h1 id="新时代的EMCAScript"><a href="#新时代的EMCAScript" class="headerlink" title="新时代的EMCAScript"></a>新时代的EMCAScript</h1><p>JavaScript是<code>EMCAScript</code>标准的一种实现，事实上是JavaScript发明在先，随后被作为EMCA的一种标准确定下来，称为<code>ECMAScript</code>，简称<code>ES</code></p>
<p>2015年<code>ES6(ES2015)</code>正式发布，并且计划每年发布一个新版本，均以<code>ES201X</code>来命名</p>
<h2 id="JavaScript的缺陷"><a href="#JavaScript的缺陷" class="headerlink" title="JavaScript的缺陷"></a>JavaScript的缺陷</h2><p>JavaScript长期以来都被视为一种玩具语言；仅在浏览器中做一些简单操作的脚本语言</p>
<p>在Web发展的初级阶段，JavaScript主要做一些dom操作，然后又出现了jQuery、Underscore等一系列类库对其做了扩展，可以认为是<strong>语法糖</strong></p>
<p>Ajax出现后开发者们意识到可以用JavaScript做更多的事情，随后出现了更多复杂的Web应用，JavaScript渐渐地被重视起来</p>
<p><strong>但这并不能掩盖JavaScript先天的不足</strong></p>
<ul>
<li>几乎无法支持模块化</li>
<li>没有很好的面向对象支持</li>
<li>没有局部作用域</li>
<li><strong>❗️各种让人“惊喜”的语法细节，例如<code>0.1+0.2</code>或者<code>[] == []</code>等</strong></li>
</ul>
<p>这些问题还没有经过广泛讨论和改进就被定义成标准也由于当时时代的原因，倒逼后来的Node也要跟着实现同样的缺陷。不过<code>ES2015</code>之后这种情况已经大有改善</p>
<h2 id="使用nvm管理Node版本"><a href="#使用nvm管理Node版本" class="headerlink" title="使用nvm管理Node版本"></a>使用nvm管理Node版本</h2><p>nvm是目前流行的Node版本管理工具，可以在当前的系统中安装多个不同版本的Node，并且可以自由切换，nvm同样可以使用npm进行安装</p>
<p><strong>👇nvm常用命令</strong></p>
<ul>
<li><code>nvm install ﹤version﹥</code>：安装某个版本的Node</li>
<li><code>nvm use ﹤version﹥</code>：切换到某个版本的Node</li>
<li><code>nvm ls</code>：列出当前安装的所有Node版本，并且显示当前使用的Node版本</li>
</ul>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%E4%B8%8B%E5%8D%882.24.35.png" alt="截屏2020-08-29 下午2.24.35"></p>
<h1 id="块级作用域"><a href="#块级作用域" class="headerlink" title="块级作用域"></a>块级作用域</h1><h2 id="ES5中的作用域"><a href="#ES5中的作用域" class="headerlink" title="ES5中的作用域"></a>ES5中的作用域</h2><p><code>ES5</code>中只有两种作用域</p>
<ul>
<li>全局作用域</li>
<li>函数作用域</li>
</ul>
<p>在JavaScript文件中声明一个变量</p>
<pre><code class="javascript">var name = &#39;0xGeekCat&#39;</code></pre>
<p>代码中的name变量属于全局作用域，这表示在同一文件中的任何位置都可以访问到该变量，如果想创建一个新的作用域，只能通过声明一个新的函数来实现</p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%E4%B8%8B%E5%8D%882.40.16.png" alt="截屏2020-08-29 下午2.40.16"></p>
<h3 id="块级作用域-1"><a href="#块级作用域-1" class="headerlink" title="块级作用域"></a>块级作用域</h3><p>大多数常用的编程语言中都有块级作用域的概念，以C语言为例，C语言可以用一对花括号来定义一个块级作用域，<strong>而在<code>ES5</code>中没有这样的设计</strong></p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%882.44.50.png" alt="截屏2020-08-29 下午2.44.50"></p>
<p>在if代码块中定义的变量在外部依然可以访问到。<strong>要想避免这种情况，通常使用一个闭包来隔离作用域</strong></p>
<pre><code class="javascript">function foo() {
    var x = 1
    if (x) {
        (function () {
            var x = 2
            console.log(x) 👈 2
        }())
    }
    console.log(x) 👈 1
}

foo()</code></pre>
<p>但实现一个闭包要写不少冗余的代码</p>
<h3 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h3><p><strong>🔔变量提升是指JavaScript解释器会将变量的声明提到当前作用域最前的现象，Node也继承了这一点</strong></p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%883.01.28.png" alt="截屏2020-08-29 下午3.01.28"></p>
<p>最后打印出的是<code>undefined</code>，这可能有点让人费解，因为执行打印一行的代码时，变量<code>msg</code>还未被定义，应该出现<code>ReferenceError: msg is not defined</code>的错误才对；实际上，在👆代码中存在一个隐式的变量提升，变量<code>msg</code>的声明被提到代码最前面</p>
<p>👇实际上的执行</p>
<pre><code class="javascript">var msg
console.log(msg)
msg = &#39;0xGeekCat&#39;</code></pre>
<p>之所以输出<code>undefined</code>，是因为变量提升仅仅提升变量的声明，并没有提升变量的值</p>
<h2 id="let关键字"><a href="#let关键字" class="headerlink" title="let关键字"></a>let关键字</h2><p>let关键字会创建一个块级作用域，使用let关键字声明的变量只能在当前块级作用域中使用</p>
<pre><code class="javascript">var i = 0
for (let i = 0; i &lt; 3; i++) {
    console.log(i) // 0 1 2
}
console.log(i) // 0</code></pre>
<p>for循环内部使用let声明的变量，和外部使用var声明的处于不同的作用域中，值互不影响</p>
<h3 id="重复声明"><a href="#重复声明" class="headerlink" title="重复声明"></a>重复声明</h3><p>在同一个块级作用域中，不能使用let关键字重复声明同一个变量</p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%883.16.34.png" alt="截屏2020-08-29 下午3.16.34"></p>
<p>在不同块级作用域中则无此限制</p>
<pre><code class="javascript">let a = 15

function scope() {
    let a = 10
    console.log(a) // 10
    if (true) {
        let a = 5
        console.log(a) // 5
    }
}
scope()
console.log(a) // 15</code></pre>
<h3 id="变量提升-1"><a href="#变量提升-1" class="headerlink" title="变量提升"></a>变量提升</h3><p>let关键字可以解决<code>ES5</code>中变量提升带来的问题，下面的代码会抛出一个错误而不是打印出<code>undefined</code></p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%883.19.49.png" alt="截屏2020-08-29 下午3.19.49"></p>
<p>👆看似<code>let</code>没有变量提升，但实际上其内部也存在变量提升，从开头命名的真正赋值这个范围被称为<code>Temporal Dead Zone</code>(临时死区)，在临时死区内无法对变量进行取值或者赋值，表现出的行为就和没有变量提升一样，<strong>❌此处体会上暂时有点不清晰</strong></p>
<h2 id="const关键字"><a href="#const关键字" class="headerlink" title="const关键字"></a>const关键字</h2><p>声明为<code>const</code>的变量不可以再被修改，也不能被重复声明，这表示<code>const</code>变量必须在声明的同时进行初始化，const的另一个适用场景是用于模块引入</p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%883.28.32.png" alt="截屏2020-08-29 下午3.28.32"></p>
<p><strong><code>const</code>声明的变量不能修改，但使用<code>const</code>修饰的对象却可以修改</strong>，这表明<code>const</code>内部是依靠指针来判断对象是否被修改的</p>
<pre><code class="javascript">const b = {name: &#39;0xGeekCat&#39;}
b.name = &#39;hacker&#39;
console.log(b.name) // hacker</code></pre>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>数组是JavaScript中的全局对象</p>
<h2 id="find-和findIndex"><a href="#find-和findIndex" class="headerlink" title="find()和findIndex()"></a>find()和findIndex()</h2><p>和原有的<code>findIndexOf</code>方法作用基本相同，用于查找数据中第一个符合条件的数组成员</p>
<p><code>find</code>函数会返回相应元素的值，<code>findIndex</code>方法会返回对应元素的索引，它们都只匹配第一个满足条件的元素；这两个方法都接受一个回调函数作为参数，<strong>对于数据的每个成员都会按顺序执行这个回调函数</strong>，因此可以自定义筛选条件</p>
<pre><code class="javascript">let array = [1, 2, -3, -4]

console.log(array.find(function (n) {
    return n &lt; 0
})) // -3

console.log(array.findIndex(function (n) {
    return n &lt; 0
})) // 2</code></pre>
<p>比起原有的<code>findIndexOf</code>方法，新增的两个方法可以用来处理<code>NaN</code></p>
<pre><code class="javascript">const arr = [&#39;a&#39;, &#39;b&#39;, NaN, &#39;c&#39;]

console.log(arr.indexOf(&#39;d&#39;)) // -1
console.log(arr.indexOf(NaN)) // -1 👈 返回-1 是因为 NaN !=== NaN
console.log(arr.indexOf(&#39;b&#39;)) // 1

console.log(arr.findIndex(function (x) {
    return Number.isNaN(x) // 2
}))</code></pre>
<h2 id="from-方法"><a href="#from-方法" class="headerlink" title="from()方法"></a>from()方法</h2><p>from方法用于将一个<code>array-like object</code>转换成数组</p>
<p>JavaScript中的参数对象<code>arguments</code>就是一个<code>array-like object</code>，可以通过<code>[]</code>来访问其中的元素，也可以通过<code>length</code>属性来得到对象的长度。但是无法通过<code>array</code>对象的方法，例如<code>pop</code>或者<code>push</code>来操作它</p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%884.06.00.png" alt="截屏2020-08-29 下午4.06.00"></p>
<p>🔔<strong>通常一个对象有length属性而且其值大于0，那么就可以看作是<code>array-like object</code></strong></p>
<p><strong>新建一个<code>array-like object</code></strong></p>
<pre><code class="javascript">var a = {}

var i = 0
while (i &lt; 10) {
    a[i] = i * i
    i ++
}

a.length = i</code></pre>
<p>在<code>ES5</code>中，开发者可以使用<code>Array.prototype.slice</code>方法来将<code>array-like</code>对象转换成真正的数组，</p>
<p><strong>❗️如果要转换一个现有的<code>object</code>，通常还要调用<code>call</code>方法，否则会返回一个空数组</strong></p>
<pre><code class="javascript">var a = {}

// ES5
var a1 = Array.prototype.slice.call(a)
a1.push(&#39;0xGeekCat&#39;)
console.log(a1) // [ &#39;0xGeekCat&#39; ]

// ES6
var a2 = Array.from(a)
a2.push(&#39;0xGeekCat&#39;) 
console.log(a2)  // [ &#39;0xGeekCat&#39; ]</code></pre>
<p>❓<code>from</code>方法为什么没有定义在<code>prototype</code>上</p>
<p><code>from</code>用于将非数组对象转换为一个array对象，而对于一个现有的array对象，在上面部署<code>from</code>方法没有意义</p>
<h2 id="fill-方法"><a href="#fill-方法" class="headerlink" title="fill()方法"></a>fill()方法</h2><p><code>fill</code>方法用一个给定的值来填充数组，通常用来初始化一个新建的<code>array</code>对象</p>
<pre><code class="javascript">var a = new Array(5)
console.log(a) // [ &lt;5 empty items&gt; ]

a.fill(1)
console.log(a) // [ 1, 1, 1, 1, 1 ]</code></pre>
<p>在<code>ES5</code>中初始化一个数组，通常要借助<code>apply</code>和<code>map</code>方法，这是一种比较<code>hack</code>的方法，而在<code>ES6</code>直接调用<code>fill</code>方法就可以完成</p>
<pre><code class="javascript">// ES5
var array = Array.apply(null, new Array(5)).map(function () {
    return 0
})

// ES6
var array = new Array(5).fill(0)</code></pre>
<h2 id="数组的遍历"><a href="#数组的遍历" class="headerlink" title="数组的遍历"></a>数组的遍历</h2><p><code>ES6</code>提供三个新的方法用于遍历数组</p>
<ul>
<li><code>entries</code></li>
<li><code>keys</code></li>
<li><code>values</code></li>
</ul>
<p>区别在于<code>keys</code>是对键名的遍历，<code>values</code>是对键值的遍历，<code>entries</code>是对键值对的遍历</p>
<pre><code class="javascript">var a = [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]

for (let i of a.keys()) {
    console.log(i)
}

for (let i of a.entries()) {
    console.log(i)
}</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%884.44.07.png" alt="截屏2020-08-29 下午4.44.07"></p>
<p>事实上凡是内部实现<code>iterator</code>接口的对象都可以使用这三个方法进行遍历。上面的代码中没有使用values方法，原因是该方法目前还没有得到广泛支持，在某些环境中可能存在<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1299593" target="_blank" rel="noopener">兼容性问题</a></p>
<h2 id="TypedArray"><a href="#TypedArray" class="headerlink" title="TypedArray"></a>TypedArray</h2><p><code>ES2015</code>新增了<code>TypedArray</code>类型，它和<code>array</code>的区别在于<code>TypedArray</code>的元素必须是同一类型。<code>TypedArray</code>的本意是为JavaScript提供访问二进制数据的能力，由于Node已经内置了<code>Buffer</code>类型，因此<code>TypedArray</code>在Node中的出镜率相对不高，在<code>TypedArray</code>标准推出后，Node中<code>Buffer</code>类型的底层改用<code>TypedArray</code>实现</p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="参数的默认值"><a href="#参数的默认值" class="headerlink" title="参数的默认值"></a>参数的默认值</h2><p><code>ES6</code>允许给函数的参数赋一个默认值</p>
<pre><code class="javascript">function greed(x = &#39;hello&#39;, y = &#39;world&#39;) {
    console.log(x, y)
}

greed() // hello world</code></pre>
<p>不能在方法体内用<code>let</code>关键字声明与参数同名的变量，否则会出现<code>SyntaxError</code></p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%885.12.07.png" alt="截屏2020-08-29 下午5.12.07"></p>
<p><strong>❌此处与书中描述有出入，书中指的是含有默认值的变量</strong></p>
<p>除了允许赋默认值外，<code>ES6</code>还允许赋默认参数，即接收一个数组名作为参数，前面使用三个点号<code>...</code>即<strong>spread运算符</strong>来标识，避免了在调用方法时写一堆参数</p>
<h2 id="Spread运算符"><a href="#Spread运算符" class="headerlink" title="Spread运算符"></a>Spread运算符</h2><p><code>Spread运算符</code>是<code>ES6</code>提出的新运算符，其实它并算不上新概念，在C语言中就已经出现，<code>spread运算符</code>可以和数组结合使用，扩展的参数</p>
<pre><code class="javascript">var arr1 = [1, 2, 3]
var arr2 = [4, 5]
console.log(...arr1, ...arr2)

var name = [...&#39;0xGeekCat&#39;]
console.log(name)</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%885.21.13.png" alt="截屏2020-08-29 下午5.21.13"></p>
<p><code>spread运算符</code>也可以作为函数的参数，表示该函数有多个参数，也可以在函数调用时使用</p>
<pre><code class="javascript">function func(x, y, z) {
    return x + y + z
}

var args = [1, 2, 3]
console.log(func(...args)) // 6</code></pre>
<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><p><code>ES6</code>提出了一种新的箭头函数，它以<code>=﹥</code>定义匿名函数</p>
<pre><code class="javascript">var func = a =&gt; a 
👇
var func = function (a) {
    return a
}</code></pre>
<p>在多参数的情况下</p>
<pre><code class="javascript">var func = (arg1 = &#39;hello&#39;, arg2 = &#39;world&#39;) =&gt; console.log(arg1, arg2)</code></pre>
<p>除简洁之外，箭头函数还有另一个优点</p>
<p><strong>🔔修复<code>this</code>作用域问题</strong></p>
<pre><code class="javascript">var date = {
    year: 2020,
    month: 8,
    day: 29,
    getDate: function () {
        var func = function () {
            return this.year + &#39;/&#39; + this.month + &#39;/&#39; + this.day
        }
        return func()
    }
}

console.log(date.getDate()) // undefined/undefined/undefined</code></pre>
<p>导致👆输出的原因是<code>func()</code>方法内部的<code>this</code>指向全局对象而非<code>date</code>对象</p>
<p><code>ES5</code>中的一种解决方法是使用临时变量保存外部<code>this</code></p>
<pre><code class="javascript">var date = {
    year: 2020,
    month: 8,
    day: 29,
    getDate: function () {
        var self = this
        console.log(self)
        var func = function () {
            return self.year + &#39;/&#39; + self.month + &#39;/&#39; + self.day
        }
        return func()
    }
}

console.log(date.getDate())</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%886.33.29.png" alt="截屏2020-08-29 下午6.33.29"></p>
<p>在<code>ES6</code>中使用箭头函数则可以完美解决问题</p>
<pre><code class="javascript">var date = {
    year: 2020,
    month: 8,
    day: 29,
    getDate: function () {
        var func = () =&gt; this.year + &#39;/&#39; + this.month + &#39;/&#39; + this.day
        return func()
    }
}

console.log(date.getDate()) // 2020/8/29</code></pre>
<h3 id="匿名函数中的this"><a href="#匿名函数中的this" class="headerlink" title="匿名函数中的this"></a>匿名函数中的this</h3><p>在<code>ES5</code>中，匿名函数默认是指向全局对象的，在浏览器中为<code>Window</code>对象，在Node中大部分情况下都会指向<code>global</code>对象，定时器API略有不同</p>
<pre><code class="javascript">function foo() {
    var func = () =&gt; console.log(this)
    func()
}
foo()</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%886.47.49.png" alt="截屏2020-08-29 下午6.47.49"></p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%886.48.52.png" alt="截屏2020-08-29 下午6.48.52"></p>
<p><code>setTimeout</code>中匿名函数的<code>this</code>指向，Node和浏览器不同，在Chrome中输出<code>window</code>对象，在Node控制台中输出一个<code>Timeout</code>对象</p>
<pre><code class="javascript">function foo() {
    setTimeout(function () {
        console.log(this)
    })
}
foo()</code></pre>
<p>使用箭头函数后，<code>this</code>的指向和<code>foo</code>函数内部相同</p>
<pre><code class="javascript">function foo() {
    this.name = &#39;0xGeekCat&#39;
    setTimeout(() =&gt; {
        console.log(this)
        console.log(this.name)
    })
}
foo()</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%886.59.31.png" alt="截屏2020-08-29 下午6.59.31"></p>
<p><strong>🔔此时浏览器中<code>this</code>还是指向Windows，证明实际上匿名函数内部并没有定义this，仅仅是引用外面一层的<code>this</code></strong></p>
<h2 id="箭头函数的陷阱"><a href="#箭头函数的陷阱" class="headerlink" title="箭头函数的陷阱"></a>箭头函数的陷阱</h2><p>箭头函数本身没有定义<code>this</code>，在箭头函数内部使用<code>this</code>关键字时，它开始在代码定义的位置向上找，直到遇见第一个<code>this</code>，这带来了很大的便利但有时也会出现一些问题</p>
<pre><code class="javascript">function Person() {
    this.name = &#39;0xGeekCat&#39;
}

Person.prototype.greet = () =&gt; console.log(this.name)

var person = new Person()
person.greet() // undefined</code></pre>
<p>👆原型方法的定义位于顶层，箭头函数中的<code>this</code>就会指向全局对象</p>
<p>JavaScript中的<code>this</code>是在运行时基于函数的执行环境决定的；如果在浏览器中运行，<code>this</code>指向了Window对象</p>
<p><strong>🔔最好还是使用最基本的定义形式，而不是用<code>prototype</code>原型对象</strong></p>
<pre><code class="javascript">var EventEmitter = require(&#39;events&#39;).EventEmitter 👈 导入EventEmitter类

class Producer extends EventEmitter {
    constructor() {
        super();
        this.status = &#39;ready&#39;
    }
}

var producer = new Producer()

producer.on(&#39;begin&#39;, function () {
    console.log(this.status) // ready
})

producer.on(&#39;begin&#39;, () =&gt; {
    console.log(this.status) // undefined
})

producer.emit(&#39;begin&#39;)</code></pre>
<p>原因同上，箭头函数的外层还是全局对象，这个隐藏的bug很难在code review阶段被发现</p>
<h1 id="Set和Map"><a href="#Set和Map" class="headerlink" title="Set和Map"></a>Set和Map</h1><p><code>ES6</code>提出了两种新的数据结构，<code>Set</code>和<code>Map</code>，<code>Set</code>的实现类似于数组，和普通数组的不同之处在于**<code>Set</code>中不能包含重复数据**</p>
<h2 id="Set和WeakSet"><a href="#Set和WeakSet" class="headerlink" title="Set和WeakSet"></a>Set和WeakSet</h2><p><strong>Set的使用</strong></p>
<pre><code class="javascript">var set = new Set([1, 2, 3, 4, 4, 5])
console.log(set) // Set(5) { 1, 2, 3, 4, 5 } 👈 自动过滤重复数据

set.add(6)
set.delete(5)
console.log(set.has(6)) // true

for (let i of set) {
    console.log(i) // 1 2 3 4 5 6
}

set.clear()
console.log(set) // Set(0) {}</code></pre>
<p><strong>Set的遍历</strong></p>
<pre><code class="javascript">let set  = new Set([1, 2, 3])

for (let i of set.keys()) {
    console.log(i)
}

for (let i of set.values()) {
    console.log(i)
}

for (let i of set.entries()) {
    console.log(i)
}</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%888.40.27.png" alt="截屏2020-08-29 下午8.40.27"></p>
<p><strong>WeakSet</strong></p>
<p><code>WeakSet</code>和<code>Set</code>的主要区别在于**<code>WeakSet</code>的成员只能是对象**</p>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%888.46.59.png" alt="截屏2020-08-29 下午8.46.59"></p>
<p><strong><code>WeakSet</code>中的<code>weak</code>一词指的是弱引用</strong>，它表示<code>WeakSet</code>中存储的是对象的弱引用，这是一个垃圾回收中的概念，在垃圾回收器的扫描过程中，一旦发现了只有弱引用的对象，就会在回收阶段将其内存回收</p>
<p>这也就表示<code>WeakSet</code>中存储的对象如果没有被其他的对象所引用，其内存空间就会被回收。由于开发者通常无法控制垃圾回收器的运行，因此<code>WeakSet</code>中的值是无法预测的。 WeakSet不支持遍历，也不能用size属性来得到其大小</p>
<p><strong><code>WeakSet</code>的优点在于对垃圾回收有利</strong>，假设在一个局部作用域中产生了一个中间值的对象，如果作用域之外没有引用这个对象，那么就可以使用<code>WeakSet</code>来存储它，在离开局部作用域之后，该对象就会在下一轮垃圾回收时被销毁</p>
<h2 id="Map和WeakMap"><a href="#Map和WeakMap" class="headerlink" title="Map和WeakMap"></a>Map和WeakMap</h2><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p><code>Map</code>表示由<strong>键值对组成的有序集合</strong>，有序表现在<code>Map</code>的遍历顺序为插入顺序，在<code>ES5</code>中虽然也有类似的结构，但<code>ES5</code>中键值对的键值只能为字符串类型，<code>ES6</code>新增的<code>Map</code>则支持多种类型作为键值，包括对象和布尔值，Map爷提供了一系列方法来访问或操作其中的数据</p>
<pre><code class="javascript">var obj = {c: 3}

var map = new Map([
    [&#39;a&#39;, 1],
    [&#39;b&#39;, 2],
    [obj, 3],
])

console.log(map.size)
console.log(map.has(&#39;a&#39;)) // 判断是否存在键值对
console.log(map.get(&#39;b&#39;)) // 获取某键值对的值
map.set(&#39;d&#39;, 4) // 如果键值对不存在则添加，存在则覆盖
map.delete(&#39;a&#39;)

console.log(map)
for (let key of map.keys()) {
    console.log(key)
}

for (let value of map.values()) {
    console.log(value)
}

for (let m of map.entries()) {
    console.log(m)
}

map.clear()
console.log(map)</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%889.02.40.png" alt="截屏2020-08-29 下午9.02.40"></p>
<h3 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h3><p><code>WeakMap</code>用法和<code>WeakSet</code>相似，作为<code>key</code>的变量必须是个对象，关于弱引用的特性和<code>WeakSet</code>相同，不再叙述</p>
<h1 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a>Iterator</h1><h2 id="ES6中的Iterator"><a href="#ES6中的Iterator" class="headerlink" title="ES6中的Iterator"></a>ES6中的Iterator</h2><p><code>ES6</code>中的<code>Iterator</code>接口通过<code>Symbol.iterator</code>属性来实现，如果对象设置了<code>Symbol.iterator</code>属性，就表示该对象是可以被遍历的，就可以用<code>next</code>方法遍历</p>
<p>👇给对象加上<code>Iterator</code>接口</p>
<pre><code class="javascript">var Iter = {
    [Symbol.iterator] : function () {
        var i = 0
        return {
            next: function () {
                return ++i
            }
        }
    }
}

var obj = new Iter[Symbol.iterator]()
console.log(obj.next()) // 1
console.log(obj.next()) // 2</code></pre>
<p>👆代码给<code>Iter</code>对象加上了<code>[Symbol.iterator]</code>接口，这个方法的特点是每次调用<code>next</code>方法，返回值就增加1，由于此处代码没有设置边界条件，就算一直调用<code>next</code>也不会出错</p>
<p>在<code>ES6</code>中<code>Iterator</code>广泛存在于各种数据结构</p>
<pre><code class="javascript">var arr = [1, 2, 3]
console.log(arr[Symbol.iterator])

var set = new Set([1, 2, 3])
console.log(set[Symbol.iterator])

var map = new Map([
    [&#39;a&#39;, 1],
    [&#39;b&#39;, 2]
])
console.log(map[Symbol.iterator])

var str = &#39;0xGeekCat&#39;
console.log(str[Symbol.iterator])

var obj = {}
console.log(obj[Symbol.iterator]) // undefined</code></pre>
<p><img src="%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E7%94%A8ES6%E4%B9%A6%E5%86%99Node-%E4%B8%8A/%E6%88%AA%E5%B1%8F2020-08-29%20%E4%B8%8B%E5%8D%889.30.47.png" alt="截屏2020-08-29 下午9.30.47"></p>
<p><strong>❗️普通对象没有<code>iterator</code>接口</strong></p>
<h2 id="Iterator的遍历"><a href="#Iterator的遍历" class="headerlink" title="Iterator的遍历"></a>Iterator的遍历</h2><p>在<code>ES6</code>中所有<strong>内部实现了<code>Symbol.iterator</code>接口的对象</strong>都可以使用<code>for / of</code>循环进行遍历</p>
<p>👆自定义的<code>Iter</code>对象不可以进行循环，需要进行修改</p>
<pre><code class="javascript">function Iter(array) {
    this.array = array
}

Iter.prototype[Symbol.iterator] = function () {
    let index = 0
    let next = () =&gt; {
        if (index &lt; this.array.length) {
            return {
                value: this.array[index++],
                done: false
            }
        } else {
            return {
                value: undefined,
                done: true
            }
        }
    }
    return {next: next}
}

let iter = new Iter([&#39;a&#39;, &#39;b&#39;])

for (let i of iter) {
    console.log(i) // a b
}</code></pre>
<h1 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h1><h2 id="新的方法"><a href="#新的方法" class="headerlink" title="新的方法"></a>新的方法</h2><h3 id="object-assign"><a href="#object-assign" class="headerlink" title="object.assign()"></a>object.assign()</h3><p>将一个对象的属性复制到另一个对象，很多开发者看到这个方法第一时间想到的就是确认该方法是深复制或者是浅复制</p>
<pre><code class="javascript">var obj1 = {a : {b: 1}}
var obj2 = Object.assign({}, obj1)
obj1.a.b = 2
console.log(obj2.a.b) // 2</code></pre>
<p>很明显，该方法实现的是一种浅拷贝</p>
<p><strong>🔔浅拷贝复制指向对象的指针，而不复制对象本身，新旧对象还是共享同一块内存</strong></p>
<h3 id="Object-setPrototypeOf"><a href="#Object-setPrototypeOf" class="headerlink" title="Object.setPrototypeOf()"></a>Object.setPrototypeOf()</h3><p><code>Object.setPrototypeOf</code>方法用来设置一个对象的<code>prototype</code>对象，返回参数对象本身，它的作用和直接设置<code>__proto__</code>属性相同</p>
<p>在ES6之前，<code>__proto__</code>属性只是一种事实的标准，不是<code>ECMAScript</code>标准中的内容，ES6将<code>__proto__</code>写入了附录中，<strong>但仍然不推荐直接使用该属性</strong></p>
<h3 id="Object-getPrototypeOf"><a href="#Object-getPrototypeOf" class="headerlink" title="Object.getPrototypeOf()"></a>Object.getPrototypeOf()</h3><p>与<code>Object.setPrototypeOf</code>方法配套，用于获得一个对象的原型对象</p>
<pre><code class="javascript">var Person = function (name, age) {
    this.name = name
    this.age = age
    this.greed = function () {
        console.log(&#39;Hello, I am&#39;, this.name)
    }
}

function Student() {}

// 设置prototype
// 方法一
var student = new Student()
Object.setPrototypeOf(student, Person)
//方法二
Student.prototype = Person
var student = new Student()
//方法三
var student = new Student()
student.__proto__ = Person

// 读取prototype
console.log(student.__proto__) // [Function: Person]
console.log(Object.getPrototypeOf(student).name) // Person</code></pre>
<h2 id="对象的遍历"><a href="#对象的遍历" class="headerlink" title="对象的遍历"></a>对象的遍历</h2><p>先设置一个对象</p>
<pre><code class="javascript">var obj = {
    name: &#39;0xGeekCat&#39;,
    age: 19,
    gender: &#39;male&#39;
}</code></pre>
<h3 id="使用for-in遍历"><a href="#使用for-in遍历" class="headerlink" title="使用for / in遍历"></a>使用<code>for / in</code>遍历</h3><pre><code class="javascript">for (let key in obj) {
    console.log(key, obj[key])
}</code></pre>
<h3 id="使用Object-keys-遍历"><a href="#使用Object-keys-遍历" class="headerlink" title="使用Object.keys()遍历"></a>使用<code>Object.keys()</code>遍历</h3><p>返回包含所有键值的数组，不包含不可枚举的属性</p>
<pre><code class="javascript">console.log(Object.keys(obj)) // [ &#39;name&#39;, &#39;age&#39;, &#39;gender&#39; ]</code></pre>
<h3 id="使用Object-getOwnPropertyNames-遍历"><a href="#使用Object-getOwnPropertyNames-遍历" class="headerlink" title="使用Object.getOwnPropertyNames()遍历"></a>使用<code>Object.getOwnPropertyNames()</code>遍历</h3><p>作用和<code>Object.keys</code>相同，区别是返回全部的属性，无论是否可枚举</p>
<pre><code class="javascript">console.log(Object.getOwnPropertyNames(obj))</code></pre>
<h3 id="枚举属性"><a href="#枚举属性" class="headerlink" title="枚举属性"></a>枚举属性</h3><p>在<code>ES5</code>中可以将一个对象的属性设置为不可枚举的，不可枚举的属性可以正常地通过<code>a.b</code>的形式访问，但无法通过<code>for / in</code>循环和<code>Object.keys</code>方法遍历</p>
<p>可以通过<code>Object.defineProperty</code>来设置一个属性是否可以被枚举</p>
<pre><code class="javascript">Object.defineProperty(obj, &#39;gender&#39;, {
    enumerable: false
})</code></pre>
<p>将<code>gender</code>的<code>enumerable</code>属性设置为<code>false</code>后，只有<code>getOwnPropertyNames</code>可以遍历到该属性</p>
<h3 id="ES6中的遍历方法"><a href="#ES6中的遍历方法" class="headerlink" title="ES6中的遍历方法"></a>ES6中的遍历方法</h3><p><code>ES6</code>在此基础上增加<code>Object.getOwnPropertySymbols()</code>和<code>Reflect.ownKeys()</code>两个方法，它们都接受一个对象作为参数，前者会返回参数对象的全部<code>Symbol</code>属性，后者会返回全部属性</p>
<h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><h1 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h1>
        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/photos/wechat.png"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
        
          
            <div class="post-nepre full next">
          
            <a href="/%E3%80%8A%E6%96%B0%E6%97%B6%E6%9C%9F%E7%9A%84Node-js%E5%85%A5%E9%97%A8%E3%80%8B%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97-%E4%B8%8B.html" rel="next">
              <div class="background">
                <img class="lazyload" src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.1/img/loader/orange.progress-bar-stripe-loader.svg" data-src="" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                《新时期的Node.js入门》学习日记-常用模块(下)</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz",
        appKey: "mgOpfzbkHYqU92CV4IDlAUHQ",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="https://schema.org/Person">
          <a href="https://0xgeekcat.github.io/" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/custom/avatar.jpg" itemprop="image" alt="0xGeekCat" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="https://0xgeekcat.github.io/" itemprop="url" rel="author">0xGeekCat</a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i></p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 0xGeekCat<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2018</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.1","name":"/video/The-Pet-Girl-of-Sakurasou.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.1","name":"/video/The-Pet-Girl-of-Sakurasou.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <!-- 实现换肤功能 -->

  <div class="skin-menu no-select" id="mainskin" style="position: fixed">
 <div class="theme-controls row-container">
  <ul class="menu-list">
   <li id="white-bg"> <i class="fa fa-television" aria-hidden="true"></i></li>
   <li id="sakura-bg"> <i class="iconfont icon-sakura"></i></li>
   <li id="gribs-bg"> <i class="fa fa-slack" aria-hidden="true"></i></li>
   <li id="KAdots-bg"> <i class="iconfont icon-dots"></i></li>
   <li id="totem-bg"> <i class="fa fa-optin-monster" aria-hidden="true"></i></li>
   <li id="pixiv-bg"> <i class="iconfont icon-pixiv"></i></li>
   <li id="bing-bg"> <i class="iconfont icon-bing"></i></li>
   <li id="dark-bg"> <i class="fa fa-moon-o" aria-hidden="true"></i></li>
  </ul>
 </div>
</div>
<canvas id="night-mode-cover"></canvas>

  <div class="changeSkin-gear no-select">

  <div class="keys" id="setbtn"> 

   <span id="open-skinMenu"> 切换主题 | SCHEME TOOL  

     <i class="iconfont icon-gear inline-block rotating"></i> 

   </span>

  </div>

</div>

  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/0xGeekCat/cdn@2.2/img/custom/avatar.jpg">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">Mаксим0xGeekCat</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="https://github.com/0xGeekCat" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/categories/%E6%8A%80%E6%9C%AF/">
                  <i class="fa fa-code" aria-hidden="true"></i>
                  技术
                </a>
              </li>
            
              <li>
                <a href="/categories/%E7%94%9F%E6%B4%BB/">
                  <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  生活
                </a>
              </li>
            
              <li>
                <a href="/categories/%E8%BD%AC%E8%BD%BD/">
                  <i class="fa fa-book" aria-hidden="true"></i>
                  转载
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="javascript:;">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-list-ul faa-vertical" aria-hidden="true"></i>
            书单
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/tags/%E5%B7%B2%E8%AF%BB/">
                  <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                  已读
                </a>
              </li>
            
              <li>
                <a href="/tags/%E6%9C%AA%E8%AF%BB/">
                  <i class="fa fa-th-list faa-bounce" aria-hidden="true"></i>
                  未读
                </a>
              </li>
            
          </ul>
        
      </li>
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-leaf faa-wrench" aria-hidden="true"></i>
            关于
          </span>
        </a>
        
          <ul class="sub-menu">
            
              <li>
                <a href="/about/">
                  <i class="fa fa-meetup" aria-hidden="true"></i>
                  我？
                </a>
              </li>
            
          </ul>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>
</html>